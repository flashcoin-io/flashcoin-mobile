const Event = {
    //AUTH
    RESTORE_SESSION: 100,
    LOGIN: 101,
    LOGOUT: 102,
    CREATE_ACCOUNT: 103,
    UPDATE_ACCOUNT: 104,
    UPDATE_PASSWORD: 105,
    RESET_PASSWORD: 106,
    SEARCH_USERS: 107,
    GET_USERS_BY_UID: 108,
    UPLOAD_PROFILE_PIC: 109,
    UPLOAD_FILE_XFER: 110,
    VALIDATE_SERVICE_TICKET: 112,
    VALIDATE_SESSION_COOKIE: 113,
    USER_LOCK: 114,
    USER_UNLOCK: 115,
    SEND_VERIF_EMAIL: 116,
    VERIFY_EMAIL: 117,
    SEND_VERIF_SMS: 118,
    VERIFY_PHONE: 119,
    SET_PIN: 120,
    CHANGE_PIN: 121,
    GET_CONTACT_DETAIL_BY_USERNAME: 122,
    GET_CONTACT_DETAIL_BY_EMAIL: 123,
    CREATE_ACCOUNT_EASY: 128,
    SET_PASSWORD: 129,
    CREATE_ACCOUNT_EASY_ACK: 158,
    SET_PASSWORD_ACK: 159,

    SSO_SIGNUP: 301,
    SSO_SIGNUP_ACK: 302,
    SSO_LOGIN: 303,
    SSO_LOGIN_ACK: 304,
    SSO_GET_SESSION_TOKEN: 305,
    SSO_GET_SESSION_TOKEN_ACK: 306,
    GET_PROFILE: 307,
    GET_PROFILE_ACK: 308,
    SSO_CHECK_SESSION_TOKEN: 311,
    SSO_CHECK_SESSION_TOKEN_ACK: 312,
    PREPARE_UPGRADE_UNITY: 313,
    PREPARE_UPGRADE_UNITY_ACK: 314,
    SSO_SET_PASSWORD_V2: 317,
    SSO_SET_PASSWORD_V2_ACK: 318,
    SSO_SET_RECOVERY_KEYS: 319,
    SSO_SET_RECOVERY_KEYS_ACK: 320,
    SSO_GET_RECOVERY_KEYS: 321,
    SSO_GET_RECOVERY_KEYS_ACK: 322,
    SSO_LOGIN_V2: 323,
    SSO_LOGIN_V2_ACK: 324,
    SSO_RESET_PASSWORD: 325,
    SSO_RESET_PASSWORD_ACK: 326,
    SSO_RESET_PASSWORD_MAIL: 327,
    SSO_RESET_PASSWORD_MAIL_ACK: 328,
    SSO_GET_KEYPAIR: 329,
    SSO_GET_KEYPAIR_ACK: 330,
    SSO_CHANGE_PASSWORD: 331,
    SSO_CHANGE_PASSWORD_ACK: 332,
    SSO_GET_SESSION_TOKEN_V2: 333,
    SSO_GET_SESSION_TOKEN_V2_ACK: 334,
    START_TFA_CODE: 335,
    START_TFA_CODE_ACK: 336,
    CONFIRM_TFA_CODE: 337,
    CONFIRM_TFA_CODE_ACK: 338,
    TURN_OFF_TFA: 339,
    TURN_OFF_TFA_ACK: 340,
    CHECK_TFA_CODE: 341,
    CHECK_TFA_CODE_ACK: 342,

    CHAT_SEND: 201,
    CHAT_UPDATE: 202,
    CHAT_DELETE: 203,
    CHAT_GET_MSGS: 204,
    CHAT_TYPING: 205,
    CHAT_BROADCAST: 206,

    //ROSTER OPRNS
    ROS_GET: 401,
    ROS_OP: 402, //roster op covers req, app, rem, blck, unblck
    ROS_CONN_USER: 403,
    ROS_ADD: 405,

    //PRESENCE
    PRES_UPDT: 501,

    //ACKs
    CHAT_SEND_ACK: 231,
    CHAT_UPDATE_ACK: 232,
    CHAT_DELETE_ACK: 233,
    CHAT_GET_MSGS_ACK: 234,
    CHAT_BROADCAST_ACK: 235,

    ///////////// ROS
    ROS_GET_ACK: 431,
    ROS_OP_ACK: 432,
    ROS_CONN_USER_ACK: 433,
    ROS_ADD_ACK: 435,

    PRES_UPDT_ACK: 434,

    //RECVs
    CHAT_RECV: 261,
    CHAT_UPDT_RECV: 262,
    CHAT_DEL_RECV: 263,
    CHAT_TYPING_RECV: 264,
    CHAT_BROADCAST_RECV: 265,


    ROS_REQ_RECV: 461,
    ROS_APPRV_RECV: 462,
    ROS_REM_RECV: 463,
    ROS_UNBLK_RECV: 464,

    PRES_UPDT_RECV: 561,

    KEYS_CREATE_FLASH_WALLET: 1037,
    KEYS_CREATE_FLASH_WALLET_ACK: 1038,

    CHECK_RESET_PW_TOKEN: 1105,

    ADMIN_UPDT_PASSWORD_OF_USER: 1102,
    ADMIN_SEND_MAIL: 1103,
    ADMIN_GET_RESET_PW_TOKEN: 1104,
    REQUEST_RESET_PW: 1106,
    ADMIN_GET_RESET_PW_REQ: 1107,
    ADMIN_UPDT_RESET_PW_REQ: 1108,
    ADMIN_LOCK: 1109,
    ADMIN_UNLOCK: 1110,
    ADMIN_GET_GENERAL_STATS: 1111,
    UPGRADE_PASSWORD_V1_V2: 1112,
    ADMIN_GET_WALLET_DAILY_STATS: 1113,
    ADMIN_GET_WALLET_BL_SNAPSHOT: 1114,
    ADMIN_GET_TX_DAILY_STATS: 1115,
    ADMIN_SEARCH_USERS: 1116,
    ADMIN_SET_WALLET_CFG: 1117,

    RESTORE_SESSION_ACK: 130,
    LOGIN_ACK: 131,
    LOGOUT_ACK: 132,
    CREATE_ACCOUNT_ACK: 133,
    UPDATE_ACCOUNT_ACK: 134,
    UPDATE_PASSWORD_ACK: 135,
    RESET_PASSWORD_ACK: 136,
    SEARCH_USERS_ACK: 137,
    GET_USERS_BY_UID_ACK: 138,
    UPLOAD_PROFILE_PIC_ACK: 139,
    UPLOAD_FILE_XFER_ACK: 140,
    VALIDATE_SERVICE_TICKET_ACK: 142,
    VALIDATE_SESSION_COOKIE_ACK: 143,
    USER_LOCK_ACK: 144,
    USER_UNLOCK_ACK: 145,
    SEND_VERIF_EMAIL_ACK: 146,
    VERIFY_EMAIL_ACK: 147,
    SEND_VERIF_SMS_ACK: 148,
    VERIFY_PHONE_ACK: 149,
    SET_PIN_ACK: 150,
    CHANGE_PIN_ACK: 151,
    GET_CONTACT_DETAIL_BY_USERNAME_ACK: 152,
    GET_CONTACT_DETAIL_BY_EMAIL_ACK: 153,

    KEYS_CREATE_UNITY_WALLET: 1028,
    KEYS_CREATE_UNITY_WALLET_ACK: 1528,

    CHECK_RESET_PW_TOKEN_ACK: 1605,

    ADMIN_UPDT_PASSWORD_OF_USER_ACK: 1602,
    ADMIN_SEND_MAIL_ACK: 1603,
    ADMIN_GET_RESET_PW_TOKEN_ACK: 1604,
    REQUEST_RESET_PW_ACK: 1606,
    ADMIN_GET_RESET_PW_REQ_ACK: 1607,
    ADMIN_UPDT_RESET_PW_REQ_ACK: 1608,
    ADMIN_LOCK_ACK: 1609,
    ADMIN_UNLOCK_ACK: 1610,
    ADMIN_GET_GENERAL_STATS_ACK: 1611,
    UPGRADE_PASSWORD_V1_V2_ACK: 1612,
    ADMIN_GET_WALLET_DAILY_STATS_ACK: 1613,
    ADMIN_GET_WALLET_BL_SNAPSHOT_ACK: 1614,
    ADMIN_GET_TX_DAILY_STATS_ACK: 1615,
    ADMIN_SEARCH_USERS_ACK: 1616,
    ADMIN_SET_WALLET_CFG_ACK: 1617,

    SESSION_INVALID: 141,
    SESSION_TOKEN_RECV: 200,

    VERIFY_EMAIL_RECV: 1742,

    /* Begin - nlttoan added for SC-149: Speed-up log-in */
    CL_STORE_WALLET_DATA: 1300,
    CL_STORE_WALLET_DATA_ACK: 1301,
    CL_RESTORE_WALLET_DATA: 1302,
    CL_RESTORE_WALLET_DATA_ACK: 1303,
    /* End */

    GET_WALLET_SECRET: 309,
    GET_WALLET_SECRET_ACK: 310,
    CHECK_PIN: 315,
    CHECK_PIN_ACK: 316,

    //KEYS OPERATIONS
    KEYS_CREATE_WALLET: 1000,
    KEYS_ADD_WALLET_ADDRESS: 1001,
    KEYS_SEARCH_WALLET: 1002,
    KEYS_ADD_WALLET_KEYS: 1003,
    KEYS_UPDT_WALLET_KEYS: 1003,
    KEYS_ACTIVATE_WALLET: 1004,
    KEYS_DEACTIVATE_WALLET: 1005,
    KEYS_ADD_WALLET_CONTACT: 1006,
    KEYS_REM_WALLET_CONTACT: 1007,
    KEYS_GET_MY_WALLETS: 1008,
    KEYS_UPDT_WALLET_ADDRESS: 1009,
    KEYS_GET_WALLET_BY_EMAIL: 1010,
    KEYS_ADD_TXN_LOG: 1011,
    KEYS_GET_SENT_TXN: 1012,
    KEYS_GET_RECV_TXN: 1013,

    KEYS_ADD_MONEY_REQ: 1014,
    KEYS_GET_SENT_MONEY_REQ: 1015,
    KEYS_GET_RECV_MONEY_REQ: 1016,
    KEYS_MARK_SENT_MONEY_REQ: 1017,
    KEYS_MARK_REJECTED_MONEY_REQ: 1018,
    KEYS_MARK_CANCELLED_MONEY_REQ: 1019,
    KEYS_MARK_READ_MONEY_REQ: 1020,

    KEYS_GET_WALLET_BY_USERNAME: 1021,
    KEYS_GET_RECV_MONEY_REQ_BY_ID: 1022,
    KEYS_UPDATE_WALLET_BALANCE: 1023,

    KEYS_GET_TXN: 1024,
    KEYS_UPDATE_TXN_LOG: 1025,
    KEYS_GET_REQS: 1026,
    KEYS_GET_TXN_BY_CONTACT: 1027,
    KEYS_GET_WALLET_BALANCE: 1028,
    KEYS_CREATE_WALLET_AND_ADDRESS: 1029,
    KEYS_CREATE_USN_RAW_TXN: 1031,
    KEYS_CREATE_USN_RAW_TXN_ACK: 1032,
    KEYS_GET_TXN_DETAILS: 1033,
    KEYS_GET_TXN_DETAILS_ACK: 1034,
    KEYS_GET_BALANCE: 1035,
    KEYS_GET_BALANCE_ACK: 1036,

    KEYS_GET_LIST_MESSAGE: 1042,
    KEYS_GET_MESSAGE_BY_ID: 1043,
    KEYS_MARK_MESSAGE_AS_READ: 1044,
    KEYS_MARK_MESSAGE_AS_DELETED: 1045,
    KEYS_FOUNTAIN_ENABLE: 1045,
    KEYS_FOUNTAIN_ENABLE_ACK: 1046,
    KEYS_FOUNTAIN_DISABLE: 1047,
    KEYS_FOUNTAIN_DISABLE_ACK: 1048,
    KEYS_FOUNTAIN_MY: 1049,
    KEYS_FOUNTAIN_MY_ACK: 1050,
    KEYS_FOUNTAIN_UPDATE: 1051,
    KEYS_FOUNTAIN_UPDATE_ACK: 1052,

    ADMIN_GET_WALLETS_OF_USER: 1100,
    ADMIN_UPDT_WALLETS_OF_USER: 1101,


    //KEYS OPERATIONS ACK
    KEYS_CREATE_WALLET_ACK: 1500,
    KEYS_ADD_WALLET_ADDRESS_ACK: 1501,
    KEYS_SEARCH_WALLET_ACK: 1502,
    KEYS_ADD_WALLET_KEYS_ACK: 1503,
    KEYS_UPDT_WALLET_KEYS_ACK: 1503,
    KEYS_ACTIVATE_WALLET_ACK: 1504,
    KEYS_DEACTIVATE_WALLET_ACK: 1505,
    KEYS_ADD_CONTACT_ACK: 1506,
    KEYS_REM_CONTACT_ACK: 1507,
    KEYS_GET_MY_WALLETS_ACK: 1508,
    KEYS_UPDT_WALLET_ADDRESS_ACK: 1509,
    KEYS_GET_WALLET_BY_EMAIL_ACK: 1510,
    KEYS_ADD_TXN_LOG_ACK: 1511,
    KEYS_GET_SENT_TXN_ACK: 1512,
    KEYS_GET_RECV_TXN_ACK: 1513,

    KEYS_ADD_MONEY_REQ_ACK: 1514,
    KEYS_GET_SENT_MONEY_REQ_ACK: 1515,
    KEYS_GET_RECV_MONEY_REQ_ACK: 1516,
    KEYS_MARK_SENT_MONEY_REQ_ACK: 1517,
    KEYS_MARK_REJECTED_MONEY_REQ_ACK: 1518,
    KEYS_MARK_CANCELLED_MONEY_REQ_ACK: 1519,
    KEYS_MARK_READ_MONEY_REQ_ACK: 1520,

    KEYS_GET_WALLET_BY_USERNAME_ACK: 1521,
    KEYS_GET_RECV_MONEY_REQ_BY_ID_ACK: 1522,
    KEYS_UPDATE_WALLET_BALANCE_ACK: 1523,

    KEYS_GET_TXN_ACK: 1524,
    KEYS_UPDATE_TXN_LOG_ACK: 1525,
    KEYS_GET_REQS_ACK: 1526,
    KEYS_GET_TXN_BY_CONTACT_ACK: 1527,

    KEYS_GET_LIST_MESSAGE_ACK: 1542,
    KEYS_GET_MESSAGE_BY_ID_ACK: 1543,
    KEYS_MARK_MESSAGE_AS_READ_ACK: 1544,
    KEYS_MARK_MESSAGE_AS_DELETED_ACK: 1545,

    ADMIN_GET_WALLETS_OF_USER_ACK: 1600,
    ADMIN_UPDT_WALLETS_OF_USER_ACK: 1601,


    //KEYS OPERATIONS RECV
    KEYS_ADD_TXN_LOG_RECV: 1711,
    KEYS_UPDATE_TXN_LOG_RECV: 1712,
    KEYS_ADD_MONEY_REQ_RECV: 1714,

    KEYS_MARK_MONEY_REQ_RECV: 1719,
    KEYS_MARK_READ_MONEY_REQ_RECV: 1720,

    KEYS_ADD_MESSAGE_RECV: 1741,
    KEYS_CHECK_SESSION: 141,
    KEYS_GET_TXN_BY_ID: 1030,
    KEYS_GET_TXN_BY_ID_ACK: 1530

};

const Err = {
    unknown: 1,
    ok: 2,
    again: 3
};

const Cmd = {
    open: 1,
    ping: 2,
    close: 3,
    event: 4,
    join: 5,
    leave: 6,
    xfer_start: 7,
    xfer: 8,
    xfer_err: 9,
    xfer_end: 10,
    get_file: 11,
};

const OBJ_TYPE = {
    string: 0,
    blob: 1,
    json: 2
};

/**
 ********************************************
 * event pipe header structure
 * All fields are network byte order. The payload includes a
 * 1. header, 2. extended header, and 3. event sections.
 *
 * version  : uint8_t
 * flag     : uint16_t
 * seqno    : uint32_t
 * txn      : uint16_t
 * cmd      : uint8_t
 * ext_len  : uint16_t ; length of the extended header
 * ext_type : uint8_t : extended header type
 *                      0: string, 1. binary, 2. json stringify object
 * ext      : variable length ; extended header data
 *
 * event structure
 * event    : uint16_t : the event enumeration
 * data_len : uint32_t : the length of the data
 * data_type: uint8_t: the object type of the data payload
 * data     : the data
 */

// minimum header length
const HEADER_MIN_LEN = 12;

const Off = {
    FLAG: 1,
    SEQNO: 3,
    TXN: 7,
    CMD: 9,
    EXT_LEN: 10,
    EXT_TYPE: 12,
    EXT: 13
};


const FLAG_ACK = 0x01;

module.exports = {
    EVP_VER: 1,
    EVP_PATH: '/_evp',
    DEFAULT_NSP: null,
    Err: Err,
    Cmd: Cmd,
    HEADER_MIN_LEN: HEADER_MIN_LEN,
    Off: Off,
    FLAG_ACK: FLAG_ACK,
    OBJ_TYPE: OBJ_TYPE,
    Event: Event
}